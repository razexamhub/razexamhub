<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>munu</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <!-- ‚úÖ Amazon-style Top Nav -->
  <header class="navbar">
    <a href="index.html" class="logo">üõçÔ∏è munu</a>
    <input type="text" class="search-box" id="search" placeholder="Search products..." onkeyup="filterProducts()" />
    <a href="cart.html" class="cart-link">üõí Cart</a>
  </header>

  <!-- ‚úÖ Product Grid (dynamic from Google Sheet) -->
  <main class="product-grid" id="productGrid">
    <!-- Products will be loaded here by JavaScript -->
  </main>

  <!-- ‚úÖ JavaScript for Search and Dynamic Products -->
  <script>
    const sheetURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vS0-4wOgHqkyoqU5NV0cX9YCA7DXTF34RVy8VNrpMSWkx-jY8EzCOiphptQuamdLyOaCC8PfmtHWRCH/pub?output=csv";

    async function fetchProducts() {
      const res = await fetch(sheetURL);
      const data = await res.text();

      const rows = data.trim().split('\n').slice(1); // Skip headers
      const products = rows.map(row => {
        const cols = row.split(',');

        // Create a product object with dynamic images
        const product = {
          id: cols[0],
          name: cols[1],
          price: cols[2],
          description: cols[3],
          images: []
        };

        // Collect all image columns dynamically (image1, image2, ..., image10+)
        for (let i = 4; i < cols.length; i++) {
          const img = cols[i].trim();
          if (img) product.images.push(img);
        }

        return product;
      });

      displayProducts(products);
    }

    function displayProducts(products) {
      const grid = document.getElementById("productGrid");
      grid.innerHTML = ""; // Clear any existing items

      products.forEach(product => {
        const card = document.createElement("div");
        card.className = "product";
        card.innerHTML = `
          <a href="product.html" onclick='viewProduct(${JSON.stringify(product)})'>
            <img src="${product.images[0] || ''}" alt="${product.name}">
            <h2>${product.name}</h2>
          </a>
          <p>‚Çπ${product.price}</p>
        `;
        grid.appendChild(card);
      });
    }

    function viewProduct(product) {
      localStorage.setItem("selectedProduct", JSON.stringify(product));
    }

    function filterProducts() {
      const input = document.getElementById("search").value.toLowerCase();
      const products = document.querySelectorAll(".product");

      products.forEach(product => {
        const title = product.querySelector("h2").textContent.toLowerCase();
        product.style.display = title.includes(input) ? "block" : "none";
      });
    }

    fetchProducts();
  </script>

</body>
</html>
